{
  "kind": "RestApiPoller",
  "properties": {
    "connectorDefinitionName": "CrowdStrikeAPICCPDefinition",
    "dataType": "CrowdStrikeAlerts",
    "dcrConfig": {
      "streamName": "SENTINEL_CROWDSTRIKEALERTS",
      "dataCollectionEndpoint": "WILL_BE_POPULATED_AT_DEPLOYMENT",
      "dataCollectionRuleImmutableId": "WILL_BE_POPULATED_AT_DEPLOYMENT"
    },
    "auth": {
      "type": "OAuth2",
      "ClientId": "WILL_BE_POPULATED_AT_DEPLOYMENT",
      "ClientSecret": "WILL_BE_POPULATED_AT_DEPLOYMENT",
      "grantType": "client_credentials",
      "tokenEndpoint": "WILL_BE_POPULATED_AT_DEPLOYMENT",
      "tokenEndpointHeaders": {
        "Accept": "application/json",
        "Content-Type": "application/x-www-form-urlencoded"
      },
      "tokenEndpointQueryParameters": {},
      "authorizationEndpointHeaders": {},
      "authorizationEndpointQueryParameters": {},
      "isCredentialsInHeaders": false,
      "isJwtBearerFlow": false
    },
    "request": {
      "apiEndpoint": "WILL_BE_POPULATED_AT_DEPLOYMENT",
      "httpMethod": "POST",
      "isPostPayloadJson": true,
      "headers": {
        "Accept": "application/json",
        "Content-Type": "application/json",
        "User-Agent": "Scuba"
      },
      "queryParameters": {},
      "queryParametersTemplate": "{\r\n                    \"filter\": \"created_timestamp:>'{_QueryWindowStartTime}'+created_timestamp:<='{_QueryWindowEndTime}'\",\r\n                    \"sort\": \"created_timestamp.asc\"\r\n                }",
      "queryTimeFormat": "yyyy-MM-ddTHH:mm:ssZ",
      "queryWindowInMin": 5,
      "rateLimitQPS": 10,
      "retryCount": 3,
      "timeoutInSeconds": 91
    },
    "response": {
      "eventsJsonPaths": [
        "$.resources"
      ],
      "format": "json"
    },
    "paging": {
      "pagingType": "PersistentToken",
      "nextPageParaName": "after",
      "nextPageTokenJsonPath": "$.meta.pagination.after",
      "pageSize": 100,
      "sendNextPageTokenAsObject": false
    },
    "isActive": true,
    "shouldJoinNestedData": false,
    "stepCollectorConfigs": {}
  }
}
